---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import Calendar from '../components/Calendar.astro';

// Get all events and prayers from content collections
const eventsCollection = await getCollection('events');
const prayersCollection = await getCollection('prayers');

// Transform events to include id from entry
const events = eventsCollection.map(entry => ({
  id: entry.id,
  ...entry.data
}));

// Transform prayers
const prayers = prayersCollection.map(entry => ({
  id: entry.id,
  title: entry.data.title,
  author: entry.data.author,
  category: entry.data.category,
  text: entry.body,
  tags: entry.data.tags
}));
---

<BaseLayout title="Home - Haringey Baháʼí Community" description="Welcome to the Haringey Baháʼí Community website. Learn about the Faith, join our events, and explore spiritual resources.">
  <Hero
    title="Welcome to the Haringey Baháʼí Community"
    subtitle="A community in North London dedicated to unity, service, and spiritual growth"
    ctaText="Learn More About the Faith"
    ctaLink="/about"
  />

  <section class="py-12">
    <div class="container mx-auto px-4">
      <div class="grid md:grid-cols-3 gap-8 mb-16">
        <div class="bg-white rounded-lg shadow-md p-6 text-center">
          <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-2">Learn & Study</h3>
          <p class="text-gray-600 mb-4">Explore the sacred writings and join study circles to deepen your understanding.</p>
          <a href="/study" class="text-blue-600 hover:text-blue-800 font-medium">Explore Resources →</a>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6 text-center">
          <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-2">Connect & Serve</h3>
          <p class="text-gray-600 mb-4">Join our community activities and contribute to building a better world.</p>
          <a href="/community" class="text-blue-600 hover:text-blue-800 font-medium">Community Life →</a>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6 text-center">
          <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-2">Pray & Reflect</h3>
          <p class="text-gray-600 mb-4">Access prayers, devotional programs, and spiritual guidance.</p>
          <a href="/devotional" class="text-blue-600 hover:text-blue-800 font-medium">Devotional Resources →</a>
        </div>
      </div>

      <div class="grid lg:grid-cols-3 gap-8">
        <div class="lg:col-span-2">
          <h2 class="text-3xl font-bold text-gray-900 mb-6">About the Baháʼí Faith</h2>
          <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <p class="text-gray-700 mb-4 leading-relaxed">
              The Baháʼí Faith is a religion founded in the 19th century that teaches the essential worth of all religions
              and the unity of all people. Baháʼís believe that God has sent a series of divine Messengers throughout
              history to guide humanity's spiritual and social development.
            </p>
            <p class="text-gray-700 mb-4 leading-relaxed">
              Central to Baháʼí belief is the conviction that humanity is one single race and that the day has come for
              its unification in one global society. The principal challenge facing the peoples of the earth is to accept
              the fact of their oneness and to assist the processes of unification.
            </p>
            <a href="/about" class="inline-block bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition">
              Learn More About the Faith
            </a>
          </div>

          <h2 class="text-3xl font-bold text-gray-900 mb-6">Featured Prayer</h2>
          <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg shadow-md p-8 border border-blue-100">
            <p class="text-gray-700 italic leading-relaxed mb-4 text-lg">
              {prayers[0].text.split('\n\n')[0]}
            </p>
            <p class="text-sm text-gray-600">— {prayers[0].author}</p>
            <a href="/devotional/prayers" class="inline-block mt-4 text-blue-600 hover:text-blue-800 font-medium">
              View More Prayers →
            </a>
          </div>
        </div>

        <div>
          <Calendar events={events} />
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
