---
import BaseLayout from "../layouts/BaseLayout.astro";
import Hero from "../components/Hero.astro";
import Calendar from "../components/Calendar.astro";
import { getPublishedItems, expandRecurringEventsSync } from "../lib/directus";
import { getNextOccurrences, formatEventDate } from "../lib/recurrence";
import type { Event, Prayer } from "../lib/directus";

// Get all published events and prayers from Directus
const events = await getPublishedItems<Event>("events");
const prayers = await getPublishedItems<Prayer>("prayers");

// Expand recurring events to show next 5 occurrences each
const eventOccurrences = expandRecurringEventsSync(
  events,
  getNextOccurrences,
  formatEventDate,
  5,
);
---

<BaseLayout
  title="Home - Haringey Baháʼí Community"
  description="Welcome to the Haringey Baháʼí Community website. Learn about the Faith, join our events, and explore spiritual resources."
>
  <Hero
    title="Welcome to the Haringey Baháʼí Community"
    subtitle="A community in North London dedicated to unity, service, and spiritual growth"
    imageUrl="/images/bahai/buildings/shrine-bab/shrine-bab-001.jpg"
    overlayOpacity={60}
  />

  <section class="py-12">
    <div class="container mx-auto px-4">
      <div class="grid md:grid-cols-3 gap-8 mb-16">
        <div class="bg-base-200 rounded-lg shadow-md p-6 text-center">
          <div
            class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4"
          >
            <svg
              class="w-8 h-8 text-primary"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
              ></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-2">Learn & Study</h3>
          <p class="text-base-content opacity-70 mb-4">
            Explore the sacred writings and join study circles to deepen your
            understanding.
          </p>
          <a
            href="/study"
            class="text-accent-cyan hover:text-accent-cyan-dark font-medium"
            >Explore Resources →</a
          >
        </div>

        <div class="bg-base-200 rounded-lg shadow-md p-6 text-center">
          <div
            class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4"
          >
            <svg
              class="w-8 h-8 text-primary"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
              ></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-2">Connect & Serve</h3>
          <p class="text-base-content opacity-70 mb-4">
            Join our community activities and contribute to building a better
            world.
          </p>
          <a
            href="/community"
            class="text-accent-cyan hover:text-accent-cyan-dark font-medium"
            >Community Life →</a
          >
        </div>

        <div class="bg-base-200 rounded-lg shadow-md p-6 text-center">
          <div
            class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4"
          >
            <svg
              class="w-8 h-8 text-primary"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
              ></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-2">Pray & Reflect</h3>
          <p class="text-base-content opacity-70 mb-4">
            Access prayers, devotional programs, and spiritual guidance.
          </p>
          <a
            href="/devotional"
            class="text-accent-cyan hover:text-accent-cyan-dark font-medium"
            >Devotional Resources →</a
          >
        </div>
      </div>
    </div>
  </section>

  <!-- Intro Section for Spiritual Seekers -->
  <section class="py-12 bg-gradient-to-b from-primary/5 to-base-100">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto text-center">
        <p class="text-xl text-base-content opacity-90 leading-relaxed mb-8">
          Whether you are rooted in a faith tradition or walking your own path,
          we invite you to pause, reflect, and explore how the Bahá'í vision of
          oneness might speak to your own experience of faith.
        </p>
      </div>
    </div>
  </section>

  <!-- One Light, Many Lamps Section -->
  <section class="py-16 bg-base-100">
    <div class="container mx-auto px-4">
      <div class="max-w-5xl mx-auto">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold text-base-content mb-4">
            One Light, Many Lamps
          </h2>
          <p
            class="text-xl text-base-content opacity-90 leading-relaxed max-w-3xl mx-auto"
          >
            The Bahá'í Faith teaches that all religions are expressions of one
            divine truth revealed through different messengers across time and
            cultures. These sacred voices, though speaking in different tongues
            and times, share a common call to love, justice, and unity.
          </p>
        </div>

        <div class="grid md:grid-cols-2 gap-6">
          <div
            class="bg-gradient-to-br from-primary/5 to-card border-l-4 border-primary rounded-lg p-6 shadow-md"
          >
            <p class="text-base-content italic text-lg mb-3 leading-relaxed">
              "The earth is but one country, and mankind its citizens."
            </p>
            <p class="text-base-content opacity-70 font-medium">
              — Bahá'u'lláh
            </p>
          </div>

          <div
            class="bg-gradient-to-br from-secondary/10 to-card border-l-4 border-secondary rounded-lg p-6 shadow-md"
          >
            <p class="text-base-content italic text-lg mb-3 leading-relaxed">
              "To every nation We have sent a messenger."
            </p>
            <p class="text-base-content opacity-70 font-medium">
              — Qur'an 10:47
            </p>
          </div>

          <div
            class="bg-gradient-to-br from-primary/10 to-card border-l-4 border-accent-cyan rounded-lg p-6 shadow-md"
          >
            <p class="text-base-content italic text-lg mb-3 leading-relaxed">
              "Love your neighbor as yourself."
            </p>
            <p class="text-base-content opacity-70 font-medium">
              — Leviticus 19:18
            </p>
          </div>

          <div
            class="bg-gradient-to-br from-primary/8 to-card border-l-4 border-accent-cyan-dark rounded-lg p-6 shadow-md"
          >
            <p class="text-base-content italic text-lg mb-3 leading-relaxed">
              "Whenever righteousness declines and injustice rises, I manifest
              Myself."
            </p>
            <p class="text-base-content opacity-70 font-medium">
              — Bhagavad Gītā 4:7
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Awaken the Search Within Section -->
  <section class="py-16 bg-gradient-to-b from-primary/5 to-base-100">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <div class="bg-base-200 rounded-lg shadow-lg p-8 md:p-12">
          <h2 class="text-4xl font-bold text-base-content mb-6">
            Awaken the Search Within
          </h2>

          <p class="text-lg text-base-content opacity-90 leading-relaxed mb-6">
            In the Bahá'í Faith, the <strong
              >independent investigation of truth</strong
            > is not just encouraged — it is a sacred responsibility. Every person
            has the right and the duty to seek spiritual understanding for themselves,
            free from blind imitation or inherited prejudice.
          </p>

          <p class="text-lg text-base-content opacity-90 leading-relaxed mb-8">
            This principle recognizes that spiritual truth must resonate within
            your own heart and mind. Your journey is yours alone, yet shared by
            all who seek.
          </p>

          <div
            class="bg-primary/5 rounded-lg p-6 border-l-4 border-primary mb-8"
          >
            <h3 class="text-xl font-semibold text-base-content mb-4">
              Reflection Prompts
            </h3>
            <ul class="space-y-3 text-base-content opacity-90">
              <li class="flex items-start gap-3">
                <svg
                  class="w-6 h-6 text-primary flex-shrink-0 mt-1"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span>What truths feel most alive in you today?</span>
              </li>
              <li class="flex items-start gap-3">
                <svg
                  class="w-6 h-6 text-primary flex-shrink-0 mt-1"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span
                  >How might your actions reflect the unity you believe in?</span
                >
              </li>
              <li class="flex items-start gap-3">
                <svg
                  class="w-6 h-6 text-primary flex-shrink-0 mt-1"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span>What does it mean to seek truth without prejudice?</span>
              </li>
            </ul>
          </div>

          <div class="text-center">
            <a
              href="/study"
              class="inline-block bg-primary hover:bg-accent-cyan-dark text-white px-8 py-3 rounded-lg font-medium transition shadow-md"
            >
              Explore Study Resources
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Faith in Action Section -->
  <section class="py-16 bg-base-100">
    <div class="container mx-auto px-4">
      <div class="max-w-5xl mx-auto">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold text-base-content mb-4">
            Faith in Action
          </h2>
          <p
            class="text-xl text-base-content opacity-90 leading-relaxed max-w-3xl mx-auto"
          >
            Spiritual belief finds its truest expression in action. The Bahá'í
            teachings emphasize that faith must be lived through service,
            justice, and the building of unity in our communities.
          </p>
        </div>

        <div class="grid md:grid-cols-3 gap-6 mb-12">
          <div
            class="bg-base-200 rounded-lg shadow-md p-6 border-t-4 border-secondary"
          >
            <div
              class="w-12 h-12 bg-secondary/20 rounded-full flex items-center justify-center mb-4"
            >
              <svg
                class="w-6 h-6 text-secondary"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
                ></path>
              </svg>
            </div>
            <h3 class="text-xl font-semibold text-base-content mb-3">
              Building Community
            </h3>
            <p class="text-base-content opacity-90 leading-relaxed">
              Creating spaces where people of all backgrounds come together in
              devotion, study, and service.
            </p>
          </div>

          <div
            class="bg-base-200 rounded-lg shadow-md p-6 border-t-4 border-primary"
          >
            <div
              class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4"
            >
              <svg
                class="w-6 h-6 text-primary"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                ></path>
              </svg>
            </div>
            <h3 class="text-xl font-semibold text-base-content mb-3">
              Education & Empowerment
            </h3>
            <p class="text-base-content opacity-90 leading-relaxed">
              Fostering universal education, with special emphasis on the
              empowerment of girls and women.
            </p>
          </div>

          <div
            class="bg-base-200 rounded-lg shadow-md p-6 border-t-4 border-accent-cyan"
          >
            <div
              class="w-12 h-12 bg-accent-cyan/10 rounded-full flex items-center justify-center mb-4"
            >
              <svg
                class="w-6 h-6 text-accent-cyan"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"
                ></path>
              </svg>
            </div>
            <h3 class="text-xl font-semibold text-base-content mb-3">
              Justice & Equality
            </h3>
            <p class="text-base-content opacity-90 leading-relaxed">
              Working toward the equality of all people, eliminating prejudice
              and building a just society.
            </p>
          </div>
        </div>

        <div
          class="bg-gradient-to-r from-primary/5 to-secondary/10 rounded-lg p-8 border border-primary/20"
        >
          <h3 class="text-2xl font-bold text-base-content mb-4">
            See Unity in Action
          </h3>
          <p class="text-base-content opacity-90 mb-6 leading-relaxed">
            Around the world, Bahá'ís and their friends are building vibrant
            communities rooted in service, learning, and spiritual growth.
            Discover how these values are being lived every day.
          </p>
          <div class="flex flex-wrap gap-4">
            <a
              href="/community"
              class="bg-primary hover:bg-accent-cyan-dark text-white px-6 py-3 rounded-lg font-medium transition"
            >
              Community Life
            </a>
            <a
              href="/events"
              class="bg-base-200 hover:bg-base-300 text-accent-cyan border-2 border-primary px-6 py-3 rounded-lg font-medium transition"
            >
              Join an Event
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
